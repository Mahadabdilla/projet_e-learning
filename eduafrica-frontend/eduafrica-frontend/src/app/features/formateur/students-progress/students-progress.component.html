<div class="students-progress-container">
  <div class="header">
    <div class="header-content">
      <div>
        <button class="btn-back" (click)="goBack()">
          <span>â†</span> Retour
        </button>
        <h1>Suivi des Apprenants</h1>
        <p *ngIf="formation" class="formation-title">{{ formation.title }}</p>
      </div>
      <div class="stats-summary" *ngIf="enrollments.length > 0">
        <div class="stat-item">
          <span class="stat-label">Total apprenants</span>
          <span class="stat-value">{{ enrollments.length }}</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Progression moyenne</span>
          <span class="stat-value">
            {{ getAverageProgress() }}%
          </span>
        </div>
        <div class="stat-item">
          <span class="stat-label">ComplÃ©tÃ©s</span>
          <span class="stat-value">
            {{ getCompletedCount() }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="spinner"></div>
    <p>Chargement des donnÃ©es...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="!isLoading && error" class="error-state">
    <div class="error-icon">âš ï¸</div>
    <h3>Erreur</h3>
    <p>{{ error }}</p>
    <button (click)="loadData()" class="btn-retry">RÃ©essayer</button>
  </div>

  <!-- Students List -->
  <div *ngIf="!isLoading && !error" class="students-list">
    <div *ngIf="enrollments.length === 0" class="empty-state">
      <div class="empty-icon">ğŸ‘¥</div>
      <h3>Aucun apprenant inscrit</h3>
      <p>Les apprenants qui s'inscriront Ã  cette formation apparaÃ®tront ici.</p>
    </div>

    <div *ngFor="let enrollment of enrollments" class="student-card">
      <div class="student-info">
        <div class="student-avatar">
          {{ enrollment.user.firstName.charAt(0) }}{{ enrollment.user.lastName.charAt(0) }}
        </div>
        <div class="student-details">
          <h3 class="student-name">{{ enrollment.user.firstName }} {{ enrollment.user.lastName }}</h3>
          <p class="student-email">{{ enrollment.user.email }}</p>
          <div class="enrollment-meta">
            <span class="meta-item">
              <span class="meta-icon">ğŸ“…</span>
              Inscrit le {{ formatDate(enrollment.enrolledAt) }}
            </span>
            <span *ngIf="enrollment.completedAt" class="meta-item">
              <span class="meta-icon">âœ…</span>
              ComplÃ©tÃ© le {{ formatDate(enrollment.completedAt) }}
            </span>
            <span *ngIf="enrollment.lastAccessedAt" class="meta-item">
              <span class="meta-icon">ğŸ•’</span>
              DerniÃ¨re activitÃ©: {{ formatDate(enrollment.lastAccessedAt) }}
            </span>
          </div>
        </div>
      </div>

      <div class="progress-section">
        <div class="progress-header">
          <span class="progress-label">Progression</span>
          <span class="progress-percentage">{{ enrollment.progress }}%</span>
        </div>
        <div class="progress-bar-container">
          <div
            class="progress-bar"
            [class]="'progress-' + getProgressColor(enrollment.progress)"
            [style.width]="enrollment.progress + '%'"
          ></div>
        </div>
        <div class="progress-status">
          <span *ngIf="enrollment.progress === 100" class="status-completed">
            âœ… Formation complÃ©tÃ©e
          </span>
          <span *ngIf="enrollment.progress < 100 && enrollment.progress >= 50" class="status-in-progress">
            ğŸ”„ En cours
          </span>
          <span *ngIf="enrollment.progress < 50" class="status-started">
            ğŸš€ DÃ©butÃ©
          </span>
        </div>
      </div>
    </div>
  </div>
</div>

