<div class="payment-modal-overlay" (click)="cancelPayment()">
  <div class="payment-modal" (click)="$event.stopPropagation()">
    <div class="payment-header">
      <h2>Paiement de la formation</h2>
      <button class="close-btn" (click)="cancelPayment()">×</button>
    </div>

    <div class="payment-content" *ngIf="formation">
      <!-- Formation Info -->
      <div class="formation-summary">
        <h3>{{ formation.title }}</h3>
        <p class="formation-price">
          <span class="price-label">Montant à payer :</span>
          <span class="price-value">{{ formation.price | number }} FCFA</span>
        </p>
      </div>

      <!-- Success Message -->
      <div *ngIf="success" class="success-message">
        <div class="success-icon">✅</div>
        <h3>Paiement réussi !</h3>
        <p>Votre paiement a été confirmé. Vous pouvez maintenant accéder à la formation.</p>
      </div>

      <!-- Payment Form -->
      <div *ngIf="!success && !currentPayment" class="payment-form">
        <div class="form-group">
          <label>Méthode de paiement *</label>
          <div class="payment-methods">
            <label 
              *ngFor="let method of paymentMethods" 
              class="payment-method-option"
              [class.selected]="selectedPaymentMethod === method.value">
              <input 
                type="radio" 
                [value]="method.value" 
                [(ngModel)]="selectedPaymentMethod"
                name="paymentMethod">
              <span class="method-icon">{{ method.icon }}</span>
              <span class="method-label">{{ method.label }}</span>
            </label>
          </div>
        </div>

        <!-- Numéro de téléphone pour Mobile Money -->
        <div 
          *ngIf="selectedPaymentMethod === 'ORANGE_MONEY' || selectedPaymentMethod === 'WAVE' || selectedPaymentMethod === 'M_PESA' || selectedPaymentMethod === 'MOBILE_MONEY'"
          class="form-group">
          <label>Numéro de téléphone *</label>
          <input 
            type="tel" 
            [(ngModel)]="phoneNumber"
            placeholder="Ex: +221 77 123 45 67"
            class="form-control"
            required>
          <small class="form-hint">Entrez votre numéro de téléphone Mobile Money</small>
        </div>

        <div *ngIf="error" class="error-message">
          {{ error }}
        </div>

        <div class="payment-actions">
          <button type="button" class="btn-cancel" (click)="cancelPayment()">Annuler</button>
          <button 
            type="button" 
            class="btn-pay" 
            (click)="initiatePayment()"
            [disabled]="isLoading">
            <span *ngIf="isLoading" class="spinner"></span>
            {{ isLoading ? 'Traitement...' : 'Payer ' + (formation.price | number) + ' FCFA' }}
          </button>
        </div>
      </div>

      <!-- Payment Processing -->
      <div *ngIf="!success && currentPayment" class="payment-processing">
        <div class="processing-icon">⏳</div>
        <h3>Traitement du paiement...</h3>
        <p>Veuillez patienter pendant que nous traitons votre paiement.</p>
        <p class="transaction-id">Transaction ID: {{ currentPayment.transactionId }}</p>
      </div>
    </div>
  </div>
</div>


